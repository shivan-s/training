{% load i18n %}
<div class="tile is-ancestor">
    <div class="tile is-parent is-vertical">
        <div class="tile is-child card">
            <header class="card-header">
                <p class="card-header-title is-centered">{% translate "Programme Details" %}</p>
            </header>
            <div id="#indicator-programme-{{ programme.pk }}" class="htmx-indicator">
                <progress class="progress is-small is-info" max="100"></progress>
            </div>
            <div class="card-content">
                <form method="post"
                    hx-post="{{ programme.get_hx_edit_url }}"
                    hx-swap="outerHTML"
                    hx-trigger="change"
                    hx-indicator="#indicator-programme-{{ programme.pk }}">
                    {% csrf_token %}
                    {% for field in form %}
                        <div class="field">
                            <div class="label">{{ field.label }}</div>
                            {% if field.name == "session_type" %}
                                <p class="control select is-small">{{ field }}</p>
                            {% else %}
                                <p class="control">{{ field }}</p>
                            {% endif %}
                        </div>
                    {% endfor %}
                </form>
            </div>
        </div>
        {% for exercise_form, exercise_sets_formset in formset.items %}
            {% include "coaches/programme_sessions/update/partials/exercise_form.html" with exercise_form=exercise_form exercise_sets_formset=exercise_sets_formset %}
        {% endfor %}
        <div class="tile is-child">
            <form method="post"
                hx-post="{{ programme.get_hx_coach_exercise_new }}"
                hx-swap="outerHTML"
                hx-trigger="change">
                {% csrf_token %}
                <button class="button is-success" action="submit">
                    <span class="icon is-small">
                        <i class="fas fa-plus"></i>
                    </span>
                    <span>{% translate "Add Exercise" %}</span>
                </button>
            </form>
        </div>
        <div class="tile is-child">{% include "partials/history.html" with history=programme.history.all %}</div>
        <div class="tile is-child">
            <div class="buttons">
                <button class="button is-danger"
                    hx-delete="{{ programme.get_hx_delete_url }}"
                    {% if programme.deleted %} disabled{% endif %}>
                    <span class="icon is-small">
                        <i class="fas fa-trash"></i>
                    </span>
                    <span>{% translate "Delete Programme" %}</span>
                </button>
                {% if programme.deleted %}
                    <button class="button is-success is-light"
                        hx-delete="{{ programme.get_hx_delete_url }}"
                        {% if programme.deleted %} disabled{% endif %}>
                        <span class="icon is-small">
                            <i class="fas fa-trash"></i>
                        </span>
                        <span>{% translate "Restore" %}</span>
                    </button>
                {% endif %}
            </div>
        </div>
    </div>
</div>
