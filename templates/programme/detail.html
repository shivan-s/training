{% extends "base/base.html" %}
{% load i18n %}
{% block title %}
    - {{ programme.date|date:"l (jS M)" }}
{% endblock title %}
{% block content %}
    <div>
        <div class="box">
            <div class="block">
                <h3 class="title has-text-primary">
                    {{ programme.date|date:"l (jS M)" }}
                    {% if programme.session_type %}- {{ programme.get_session_type_display }}{% endif %}
                </h3>
                {% with recent=programme.history.last %}
                    <p class="subtitle has-text-primary" title={{ recent.date }}>Last updated: {{ recent.date|timesince }}
                    </p>
                {% endwith %}
                {% for exercise in programme.exercise_set.all %}
                    <div class="block">
                        <p class="has-text-weight-bold">
                            <a href="">{{ exercise }}</a>
                        </p>
                        <ul>
                            {% for intended_set in exercise.intended.all %}<li>{{ intended_set }}</li>{% endfor %}
                        </ul>
                        {% if exercise.coach_notes %}
                            <div class="block">
                                <strong>{% translate "Notes" %}</strong>: {{ exercise.coach_notes }}
                            </div>
                        {% endif %}
                    </div>
                {% endfor %}
                {% if programme.coach_notes %}
                    <div class="block">
                        <strong>{% translate "Notes" %}</strong>: {{ programme.coach_notes }}
                    </div>
                {% endif %}
                <div class="block">
                    {% for comment in programme.comment.all %}
                        {% include "components/comment.html" with comment=comment %}
                    {% endfor %}
                    <div id="new_comment">
                        {% if new_comment %}
                            {% include "components/comment.html" with comment=new_comment %}
                        {% endif %}
                    </div>
                </div>
                <div class="block">
                    <form method="post"
                        hx-post="{% url "project:programme-session-detail" programme.pk %}"
                        hx-target="#new_comment"
                        hx-select="#new_comment"
                        hx-swap="afterend">
                        {% csrf_token %}
                        <span class="field">
                            <input class="input" type="text" name="comment" />
                            {% include "components/primary_form_button.html" with value="Post" %}
                        </span>
                    </form>
                </div>
            </div>
        </div>
        <div class="block is-flex is-justify-content-space-between">
            {% if previous_programme %}
                <a href="{% url "project:programme-session-detail" previous_programme.pk %}"
                    class="button is-primary is-inverted is-outlined">
                    <span>
                        <i class="fas fa-caret-left"></i>
                        Previous
                    </span>
                </a>
            {% else %}
                <button disabled class="button is-primary is-inverted is-outlined">
                    <span>
                        <i class="fas fa-caret-left"></i>
                        Previous
                    </span>
                </button>
            {% endif %}
            {% if next_programme %}
                <a href="{% url "project:programme-session-detail" next_programme.pk %}"
                    class="button is-primary is-inverted is-outlined">
                    <span>
                        Next
                        <i class="fas fa-caret-right"></i>
                    </span>
                </a>
            {% else %}
                <button disabled class="button is-primary is-inverted is-outlined">
                    <span>
                        Next
                        <i class="fas fa-caret-right"></i>
                    </span>
                </button>
            {% endif %}
        </div>
    </div>
{% endblock content %}
